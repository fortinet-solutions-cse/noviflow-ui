<!DOCTYPE html>
<html>

<head>
    <title>FortiElastic CGNAT</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="dist/jquery.knob.min.js"></script>
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
        
    <style>
        .square {
          height: 10px;
          width: 10px;
          background-color: #FF0000;
        }
        </style>
</head>
<style type="text/css" media="screen">
    #fgtload_time1 {
        background:url('green.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtload_time2 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtload_time3 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtload_time4 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtload_time5 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtload_time6 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtload_time7 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtload_time8 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time1 {
        background:url('green.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time2 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time3 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time4 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time5 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time6 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time7 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }
     #fgtsess_time8 {
        background:url('red.png') 0% 0%;
        background-position: center;
        background-repeat: no-repeat;
        height:50%;
        opacity: 0.5;
     }     .wrapper {
        display: flex;
        align-items: stretch;
    }
    
    #sidebar {
        min-width: 250px;
        max-width: 250px;
        min-height: 100vh;
    }
    
    #sidebar.active {
        margin-left: -250px;
    }
    a[data-toggle="collapse"] {
        position: relative;
    }
    
    .dropdown-toggle::after {
        display: block;
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
    }

    @media (max-width: 768px) {
        #sidebar {
            margin-left: -250px;
        }
        #sidebar.active {
            margin-left: 0;
        }
    }

    @import "https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700";


    body {
        font-family: 'Poppins', sans-serif;
        background: #fafafa;
    }
    
    #sidebar p {
        font-family: 'Poppins', sans-serif;
        font-size: 1.1em;
        font-weight: 300;
        line-height: 1.7em;
        color: #999;
    }
    
    #sidebar a, a:hover, a:focus {
        color: inherit;
        text-decoration: none;
        transition: all 0.3s;
    }
    
    #sidebar {
        /* don't forget to add all the previously mentioned styles here too */
        background: rgb(184, 30, 30);
        color: #fff;
        transition: all 0.3s;
    }
    
    #sidebar .sidebar-header {
        padding: 20px;
        background: #ca1e00;
    }
    
    #sidebar ul.components {
        padding: 20px 0;
        border-bottom: 1px solid #ca1e00;
    }
    
    #sidebar ul p {
        color: #fff;
        padding: 10px;
    }
    
    #sidebar ul li a {
        padding: 10px;
        font-size: 1.1em;
        display: block;
    }
    #sidebar ul li a:hover {
        color: #7386D5;
        background: #fff;
    }
    
    #sidebar ul li.active > a, a[aria-expanded="true"] {
        color: #fff;
        background: #ca1e00;
    }
    #sidebar ul ul a {
        font-size: 0.9em !important;
        padding-left: 30px !important;
        background: #ca1e00;
    }
    .dropdown-toggle {
        color: #000000
    }
    .nav-pills > li.active >a, .nav-pills > li.active >a:focus {
        color: #FFFFFF;
        background-color: #ca1e00
    }
    .nav-pills > li.active >a:hover {
        color: #FFFFFF;
        background-color: #FF0000
    }

</style>
<script>
    $(function() {
        var template_cpuload_time = {
            chart: {
                type: 'line',
                animation: false
            },
            title: {
                text: 'Host1',
                align: 'center'

            },
            yAxis: {
                title: {
                    text: '% CPU Load'
                },
                min: 0,
                max: 100,
                tickInterval: 50

            },
            legend: false,
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: false
                    },
                    enableMouseTracking: false
                }
            },
            series: [{
                marker: {
                    enabled: false,
                }
            }]
        };

        var template_cpuload_time1 = $.extend(true, {}, template_cpuload_time);
        template_cpuload_time1.title.text = "Host 1";
        $('#cpuload_time1').highcharts(template_cpuload_time1);

        var template_cpuload_time2 = $.extend(true, {}, template_cpuload_time);
        template_cpuload_time2.title.text = "Host 2";
        template_cpuload_time2.yAxis.title.text = '';
        $('#cpuload_time2').highcharts(template_cpuload_time2);

        var template_fgtload_time = $.extend(true, {}, template_cpuload_time);
        template_fgtload_time.chart.backgroundColor = 'rgba(0,0,0,0)'
        template_fgtload_time.colors = ['#3F30A0'];
        template_fgtload_time.title.color = '#FFEEEE'
        template_fgtload_time.series = [{
            marker: {
                enabled: false,
            }
        }];

        var template_fgtload_time1 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time1.title.text = "FGT1";
        $('#fgtload_time1').highcharts(template_fgtload_time1);

        var template_fgtload_time2 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time2.title.text = "FGT2";
        template_fgtload_time2.yAxis.title.text = '';
        $('#fgtload_time2').highcharts(template_fgtload_time2);

        var template_fgtload_time3 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time3.title.text = "FGT3";
        template_fgtload_time3.yAxis.title.text = '';
        $('#fgtload_time3').highcharts(template_fgtload_time3);

        var template_fgtload_time4 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time4.title.text = "FGT4";
        template_fgtload_time4.yAxis.title.text = '';
        $('#fgtload_time4').highcharts(template_fgtload_time4);

        var template_fgtload_time5 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time5.title.text = "FGT5";
        template_fgtload_time5.yAxis.title.text = '';
        $('#fgtload_time5').highcharts(template_fgtload_time5);

        var template_fgtload_time6 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time6.title.text = "FGT6";
        template_fgtload_time6.yAxis.title.text = '';
        $('#fgtload_time6').highcharts(template_fgtload_time6);

        var template_fgtload_time7 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time7.title.text = "FGT7";
        template_fgtload_time7.yAxis.title.text = '';
        $('#fgtload_time7').highcharts(template_fgtload_time7);

        var template_fgtload_time8 = $.extend(true, {}, template_fgtload_time);
        template_fgtload_time8.title.text = "FGT8";
        template_fgtload_time8.yAxis.title.text = '';
        $('#fgtload_time8').highcharts(template_fgtload_time8);


        var template_fgtsess_time = $.extend(true, {}, template_cpuload_time);
        template_fgtsess_time.chart.backgroundColor = 'rgba(0,0,0,0)'
        template_fgtsess_time.colors = ['#3F30A0'];
        template_fgtsess_time.title.color = '#FFEEEE'
        template_fgtsess_time.yAxis.title.text = "Session Setup Rate"
        template_fgtsess_time.yAxis.max = 20000
        template_fgtsess_time.yAxis.min = 0
        template_fgtsess_time.yAxis.tickInterval = 5000
        template_fgtsess_time.series = [{
            marker: {
                enabled: false,
            }
        }];

        var template_fgtsess_time1 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time1.title.text = "FGT1";
        $('#fgtsess_time1').highcharts(template_fgtsess_time1);

        var template_fgtsess_time2 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time2.title.text = "FGT2";
        template_fgtsess_time2.yAxis.title.text = '';
        $('#fgtsess_time2').highcharts(template_fgtsess_time2);

        var template_fgtsess_time3 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time3.title.text = "FGT3";
        template_fgtsess_time3.yAxis.title.text = '';
        $('#fgtsess_time3').highcharts(template_fgtsess_time3);

        var template_fgtsess_time4 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time4.title.text = "FGT4";
        template_fgtsess_time4.yAxis.title.text = '';
        $('#fgtsess_time4').highcharts(template_fgtsess_time4);

        var template_fgtsess_time5 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time5.title.text = "FGT5";
        template_fgtsess_time5.yAxis.title.text = '';
        $('#fgtsess_time5').highcharts(template_fgtsess_time5);

        var template_fgtsess_time6 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time6.title.text = "FGT6";
        template_fgtsess_time6.yAxis.title.text = '';
        $('#fgtsess_time6').highcharts(template_fgtsess_time6);

        var template_fgtsess_time7 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time7.title.text = "FGT7";
        template_fgtsess_time7.yAxis.title.text = '';
        $('#fgtsess_time7').highcharts(template_fgtsess_time7);

        var template_fgtsess_time8 = $.extend(true, {}, template_fgtsess_time);
        template_fgtsess_time8.title.text = "FGT8";
        template_fgtsess_time8.yAxis.title.text = '';
        $('#fgtsess_time8').highcharts(template_fgtsess_time8);

    });
</script>

<script>
    $(function() {
        var template_total_throughput_time = {
            chart: {
                type: 'line',
                animation: false

            },
            title: {
                text: ''
            },
            yAxis: {
                title: {
                    text: 'GBps'
                },
                min: 0,
                max: 200,
                tickInterval: 20
            },
            colors: ['#FF7200', '#AA2200', '#881133', '#910000', '#1aadce',
                '#492970', '#f28f43', '#77a1e5', '#c42525', '#a6c96a'
            ],
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: false
                    },
                    enableMouseTracking: false
                }
            },
            responsive: {
                rules: [{
                    condition: {
                        maxWidth: 500
                    },
                    chartOptions: {
                        legend: {
                            layout: 'horizontal',
                            align: 'center',
                            verticalAlign: 'bottom'
                        }
                    }
                }]
            },
            series: [{
                name: 'total',
                marker: {
                    enabled: false,
                },
                lineWidth: 5,
                color: '#FF9102'
            }, {
                name: 'ingress',
                marker: {
                    enabled: false,
                },
                color: '#E05050'
            }, {
                name: 'egress',
                marker: {
                    enabled: false,
                },
                color: '#801c1c'
            }]
        };

        $('#totalthroughput_time').highcharts(template_total_throughput_time);

        var template_fgt_throughput_time = {
            chart: {
                type: 'line',
                animation: false
            },
            title: {
                text: ''
            },
            yAxis: {
                title: {
                    text: 'Gbps'
                },
                min: 0,
                max: 25,
                tickInterval: 5
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: false
                    },
                    enableMouseTracking: false
                }
            },
            series: [{
                name: 'FGT1',
                marker: {
                    enabled: false,
                }
            }, {
                name: 'FGT2',
                marker: {
                    enabled: false,
                }
            }, {
                name: 'FGT3',
                marker: {
                    enabled: false,
                }
            }, {
                name: 'FGT4',
                marker: {
                    enabled: false,
                }
            }, {
                name: 'FGT5',
                marker: {
                    enabled: false,
                }
            }, {
                name: 'FGT6',
                marker: {
                    enabled: false,
                }
            }, {
                name: 'FGT7',
                marker: {
                    enabled: false,
                }
            }, {
                name: 'FGT8',
                marker: {
                    enabled: false,
                }
            }]
        };

        $('#fgtthroughput_time').highcharts(template_fgt_throughput_time);

    });
</script>


<!--
***********************************
  Functions to open windows
  and start/stop vms
***********************************
-->
<script>
    $(function() {

        // Action functions

        function start_fgt() {
            $("body").css("cursor", "progress");
            $('#start_fgt_btn').prop('disabled', true)
            $('#close_start_fgt_btn').prop('disabled', true)
            fortigate_id = $("#scaleout_fgt #fgt_id_scale_out").val().trim()
            $('#progress_bar_scale_out').addClass('active')                
            var intervalID = setInterval(function(){
                $.ajax({
                    url: "http://" + window.location.hostname + ":5000/progress_report",
                    type: "GET",
                    success: function(result) {
                        $('#start_vm_log').html(result);
                        re = /<!--status:([0-9]*%)-->/g
                        progress = '0%'

                        match = re.exec(result)
                        while (match != null){
                            progress = match[1]
                            match = re.exec(result)
                        }
                        $('#progress_bar_scale_out').attr('style', 'width:'+progress)
                        $('#progress_bar_scale_out').html(progress)
                    }
                });}, 500);
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/start_vm?fgt=" + fortigate_id,
                type: "POST",
                success: function(result) {
                    $('#start_vm_log').html(result);
                },
                complete: function() {
                    clearInterval(intervalID);
                    $("body").css("cursor", "default");
                    $('#close_start_fgt_btn').prop('disabled', false)
                    $('#progress_bar_scale_out').attr('style', 'width:100%')
                    $('#progress_bar_scale_out').html('100%')
                    $('#progress_bar_scale_out').removeClass('active')                
               }
            });
        };


        function stop_fgt() {
            $("body").css("cursor", "progress");
            $('#stop_fgt_btn').prop('disabled', true)
            $('#close_stop_fgt_btn').prop('disabled', true)
            fortigate_id = $("#scalein_fgt #fgt_id_scale_in").val().trim()
            $('#progress_bar_scale_in').addClass('active')                
            var intervalID = setInterval(function(){
                $.ajax({
                    url: "http://" + window.location.hostname + ":5000/progress_report",
                    type: "GET",
                    success: function(result) {
                        $('#stop_vm_log').html(result);
                        re = /<!--status:([0-9]*%)-->/g
                        progress = '0%'

                        match = re.exec(result)
                        while (match != null){
                            progress = match[1]
                            match = re.exec(result)
                        }
                        $('#progress_bar_scale_in').attr('style', 'width:'+progress)
                        $('#progress_bar_scale_in').html(progress)
                    }
                });}, 500);
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/stop_vm?fgt=" + fortigate_id,
                type: "POST",
                success: function(result) {
                    $('#stop_vm_log').html(result);
                },
                complete: function() {
                    clearInterval(intervalID);
                    $("body").css("cursor", "default");
                    $('#close_stop_fgt_btn').prop('disabled', false)
                    $('#progress_bar_scale_in').attr('style', 'width:100%')
                    $('#progress_bar_scale_in').html('100%')
                    $('#progress_bar_scale_in').removeClass('active')                
                }
            });
        };

        // Event handlers

        $("#scalingout").click(function() {
            $('#scaleout_fgt').modal('toggle');
        });

        $("#scalingin").click(function() {
            $('#scalein_fgt').modal('toggle');
        });

        $("#starttest").click(function() {
            $('#start_test').modal('toggle');
            $("body").css("cursor", "progress");
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/start_traffic",
                type: "POST",
                success: function(result) {
                    $('#start_test_log').html(result);
                },
                complete: function() {
                    $("body").css("cursor", "default");
                }
            });
        });

        $("#stoptest").click(function() {
            $('#stop_test').modal('toggle');
            $("body").css("cursor", "progress");
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/stop_traffic",
                type: "POST",
                success: function(result) {
                    $('#stop_test_log').html(result);
                },
                complete: function() {
                    $("body").css("cursor", "default");
                }
            });
        });

        $("#resetdata").click(function() {
            $("body").css("cursor", "progress");
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/reset_data",
                type: "POST",
                complete: function() {
                    $("body").css("cursor", "default");
                }
            });
        });

        $("#deleteolddata").click(function() {
            $("body").css("cursor", "progress");
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/keep_old_data?value=0",
                type: "POST",
                complete: function() {
                    $("body").css("cursor", "default");
                }
            });
        });

        $("#keepolddata").click(function() {
            $("body").css("cursor", "progress");
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/keep_old_data?value=1",
                type: "POST",
                complete: function() {
                    $("body").css("cursor", "default");
                }
            });
        });

        $("#panic").click(function() {
            $('#panic_view').modal('toggle');
            $("body").css("cursor", "progress");
            $('#close_panic_btn').prop('disabled', true)
            $('#progress_bar_panic').addClass('active')                
            var intervalID = setInterval(function(){
                $.ajax({
                    url: "http://" + window.location.hostname + ":5000/progress_report",
                    type: "GET",
                    success: function(result) {
                        $('#panic_log').html(result);
                        re = /<!--status:([0-9]*%)-->/g
                        progress = '0%'

                        match = re.exec(result)
                        while (match != null){
                            progress = match[1]
                            match = re.exec(result)
                        }
                        $('#progress_bar_panic').attr('style', 'width:'+progress)
                        $('#progress_bar_panic').html(progress)
                    }
                });}, 500);
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/panic",
                type: "POST",
                success: function(result) {
                    $('#panic_log').html(result);
                },
                complete: function() {
                    clearInterval(intervalID);
                    $("body").css("cursor", "default");
                    $('#close_panic_btn').prop('disabled', false)
                    $('#progress_bar_panic').attr('style', 'width:100%')
                    $('#progress_bar_panic').html('100%')
                    $('#progress_bar_panic').removeClass('active')
                }
            });
        });

        $("#synchronize_counters").click(function() {
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/synchronize_counters",
                type: "POST"
            });
        });

        $("#start_fgt_btn").click(start_fgt)

        $("#stop_fgt_btn").click(stop_fgt)

        // Clean modal windows when they are opened 

        $('#scaleout_fgt').on('hidden.bs.modal', function(e) {
            $(this)
                .find("input,textarea,select")
                .val('')
                .end()
                .find("input[type=checkbox], input[type=radio]")
                .prop("checked", "")
                .end();
            $('#start_fgt_btn').prop('disabled', false)
            $('#start_vm_log').html('');
            $('#progress_bar_scale_out').attr('style', 'width:0%')
            $('#progress_bar_scale_out').html('0%')
        })


        $('#scalein_fgt').on('hidden.bs.modal', function(e) {
            $(this)
                .find("input,textarea,select")
                .val('')
                .end()
                .find("input[type=checkbox], input[type=radio]")
                .prop("checked", "")
                .end();
            $('#stop_fgt_btn').prop('disabled', false)
            $('#stop_vm_log').html('');
            $('#progress_bar_scale_in').attr('style', 'width:0%')
            $('#progress_bar_scale_in').html('0%')        })

        $('#start_test').on('hidden.bs.modal', function(e) {
            $(this)
                .find("input,textarea,select")
                .val('')
                .end()
                .find("input[type=checkbox], input[type=radio]")
                .prop("checked", "")
                .end();
            $('#start_test_log').html('');
        })

        $('#stop_test').on('hidden.bs.modal', function(e) {
            $(this)
                .find("input,textarea,select")
                .val('')
                .end()
                .find("input[type=checkbox], input[type=radio]")
                .prop("checked", "")
                .end();
            $('#stop_test_log').html('');
        })

        $('#panic_view').on('hidden.bs.modal', function(e) {
            $(this)
                .find("input,textarea,select")
                .val('')
                .end()
                .find("input[type=checkbox], input[type=radio]")
                .prop("checked", "")
                .end();
            $('#panic_log').html('');
            $('#progress_bar_panic').attr('style', 'width:0%')
            $('#progress_bar_panic').html('0%')
        })

        $('#auto-mode').click(function(){
            $('#sidebar').toggleClass('active');
            setTimeout(function () {
                $('#cpuload_time1').highcharts().reflow()
                $('#cpuload_time2').highcharts().reflow()
                $('#fgtload_time1').highcharts().reflow()
                $('#fgtload_time2').highcharts().reflow()
                $('#fgtload_time3').highcharts().reflow()
                $('#fgtload_time4').highcharts().reflow()
                $('#fgtload_time5').highcharts().reflow()
                $('#fgtload_time6').highcharts().reflow()
                $('#fgtload_time7').highcharts().reflow()
                $('#fgtload_time8').highcharts().reflow()
                $('#fgtsess_time1').highcharts().reflow()
                $('#fgtsess_time2').highcharts().reflow()
                $('#fgtsess_time3').highcharts().reflow()
                $('#fgtsess_time4').highcharts().reflow()
                $('#fgtsess_time5').highcharts().reflow()
                $('#fgtsess_time6').highcharts().reflow()
                $('#fgtsess_time7').highcharts().reflow()
                $('#fgtsess_time8').highcharts().reflow()
                $('#totalthroughput_time').highcharts().reflow()
                $('#fgtthroughput_time').highcharts().reflow()
            },400);
            
        })
    });
</script>


<!--
***********************************
  Functions to fetch data regularly
***********************************
-->
<script>
    $(function() {

        function updateTitle(data, index) {
            var chart = $("#fgtload_time" + index).highcharts();
            if (data["fgtload_time" + index][(data["fgtload_time" + index].length) - 1] <= -1) {
                chart.setTitle({
                    text: "FGT" + index + " - off"
                });
                $('#fgtload_time' + index).css({opacity:0.5})
                $('#fgtload_time' + index).css("background-image", "url('red.png')")
            } else {
                chart.setTitle({
                    text: "<b>FGT" + index + " - on</b>"
                });
                $('#fgtload_time' + index).css({opacity:1})
                $('#fgtload_time' + index).css("background-image", "url('green.png')")
            }
            chart.redraw();
            var chart = $("#fgtsess_time" + index).highcharts();
            if (data["fgtsess_time" + index][(data["fgtsess_time" + index].length) - 1] <= -1) {
                chart.setTitle({
                    text: "FGT" + index + " - off"
                });
                $('#fgtsess_time' + index).css({opacity:0.5})
                $('#fgtsess_time' + index).css("background-image", "url('red.png')")
            } else {
                chart.setTitle({
                    text: "<b>FGT" + index + " - on</b>"
                });
                $('#fgtsess_time' + index).css({opacity:1})
                $('#fgtsess_time' + index).css("background-image", "url('green.png')")
            }
            chart.redraw();
            
        }


        function update_data() {
            $.ajax({
                url: "http://" + window.location.hostname + ":5000/status",
                success: function(result) {

                    var parsedJSONResult = $.parseJSON(result);

                    $('#cpuload_time1').highcharts().series[0].setData(parsedJSONResult[
                        'cpuload_time1'], true);
                    $('#cpuload_time2').highcharts().series[0].setData(parsedJSONResult[
                        'cpuload_time2'], true);

                    $('#fgtload_time1').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time1'], true);
                    $('#fgtload_time2').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time2'], true);
                    $('#fgtload_time3').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time3'], true);
                    $('#fgtload_time4').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time4'], true);
                    $('#fgtload_time5').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time5'], true);
                    $('#fgtload_time6').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time6'], true);
                    $('#fgtload_time7').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time7'], true);
                    $('#fgtload_time8').highcharts().series[0].setData(parsedJSONResult[
                        'fgtload_time8'], true);

                    $('#fgtsess_time1').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time1'], true);
                    $('#fgtsess_time2').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time2'], true);
                    $('#fgtsess_time3').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time3'], true);
                    $('#fgtsess_time4').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time4'], true);
                    $('#fgtsess_time5').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time5'], true);
                    $('#fgtsess_time6').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time6'], true);
                    $('#fgtsess_time7').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time7'], true);
                    $('#fgtsess_time8').highcharts().series[0].setData(parsedJSONResult[
                        'fgtsess_time8'], true);

                    $('#totalthroughput_time').highcharts().series[0].setData(parsedJSONResult[
                        'totalthroughput_time'], true);
                    $('#totalthroughput_time').highcharts().series[1].setData(parsedJSONResult[
                        'totalthroughput_ingress_time'], true);
                    $('#totalthroughput_time').highcharts().series[2].setData(parsedJSONResult[
                        'totalthroughput_egress_time'], true);

                    $('#fgtthroughput_time').highcharts().series[0].setData(parsedJSONResult[
                        'fgtthroughput1_time'], true);
                    $('#fgtthroughput_time').highcharts().series[1].setData(parsedJSONResult[
                        'fgtthroughput2_time'], true);
                    $('#fgtthroughput_time').highcharts().series[2].setData(parsedJSONResult[
                        'fgtthroughput3_time'], true);
                    $('#fgtthroughput_time').highcharts().series[3].setData(parsedJSONResult[
                        'fgtthroughput4_time'], true);
                    $('#fgtthroughput_time').highcharts().series[4].setData(parsedJSONResult[
                        'fgtthroughput5_time'], true);
                    $('#fgtthroughput_time').highcharts().series[5].setData(parsedJSONResult[
                        'fgtthroughput6_time'], true);
                    $('#fgtthroughput_time').highcharts().series[6].setData(parsedJSONResult[
                        'fgtthroughput7_time'], true);
                    $('#fgtthroughput_time').highcharts().series[7].setData(parsedJSONResult[
                        'fgtthroughput8_time'], true);

                    updateTitle(parsedJSONResult, 1);
                    updateTitle(parsedJSONResult, 2);
                    updateTitle(parsedJSONResult, 3);
                    updateTitle(parsedJSONResult, 4);
                    updateTitle(parsedJSONResult, 5);
                    updateTitle(parsedJSONResult, 6);
                    updateTitle(parsedJSONResult, 7);
                    updateTitle(parsedJSONResult, 8);

                    if (parsedJSONResult['vms_running'] != parsedJSONResult['vms_running_real']) {
                        $('#sync_warning').show();
                    }
                    else {
                        $('#sync_warning').hide();
                    }
                    
                    tester_case_limit = parsedJSONResult['tester_case_limit'];
                    value = tester_case_limit[tester_case_limit.length - 1];
                    if ( value != -1 ) {
                        $('#tester_throughput').val(value/1000)
                    } else {
                        $('#tester_throughput').val(0)
                    }
                    $('#tester_throughput').trigger('change');
                }
            });
        };

        setInterval(update_data, 4000);

    });
</script>
<body>
    <div class="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar" class="active">
            <div class="sidebar-header">
                <h2>Automatic mode</h2>
            </div>
            <div style="padding-left: 30px; padding-top: 30px; display:inline-block">
                Auto spawn
                <input type="checkbox" id="auto-spawn" checked data-toggle="toggle" data-onstyle="danger">
            </div>
            <div style="padding-left: 30px; padding-top: 30px; margin:auto">
                <input type="text" value="0" class="dial" data-fgColor="#FFFFFF" data-bgColor="#ca1e00" 
                    data-angleOffset="-125" data-angleArc="250" data-rotation="clockwise"
                    data-min="0" data-max="200" id="mandated_throughput">
                <script>
                    $(function() {
                        $('#mandated_throughput').knob({
                            'release': function (v) { 
                                $.ajax({
                                    url: "http://" + window.location.hostname + ":5000/update_bandwidth?value=" + v 
                                        + "&auto_spawn=" + $("#auto-spawn")[0].checked,
                                    type: "POST"
                                });
                            },
                        });
                    });
                </script>
                <div style="position: relative; left: 70px; top: -80px;font-size:25px; font-weight:normal; margin:auto">Gbps</div>
            </div>
            <div style="padding-left: 30px; padding-top: 30px; margin:auto">
                <input type="text" value="0" class="dial" data-fgColor="#BBBBBB" data-bgColor="#ca1e00" 
                    data-angleOffset="-125" data-angleArc="250" data-rotation="clockwise"
                    data-min="0" data-max="200" id="tester_throughput">
                <script>
                    $(function() {
                        $('#tester_throughput').knob({
                            'release': function (v) {},
                        });
                    });
                </script>
                <div style="position: relative; left: 70px; top: -80px;font-size:25px; font-weight:normal; margin:auto; color:#BBBBBB">Gbps</div>
            </div>
        </nav>

        <!-- Main content and charts -->

        <div class="container-fluid" style="width:100%">
            <div class="row">
                <div class="col-sm-2">
                    <a href="https://www.fortinet.com">
                            <h3 class="text-center">
                                <img src="Fortinet_Logo_Black-Red.png" alt="Fortinet" style="width:300px;">
                            </h3>
                    </a>
                </div>
                <div class="col-sm-8">
                    <h1 class="text-center">
                        <b>Elastic CGNAT - Virtual FortiGate</b>
                    </h1>
                </div>
                <div class="col-sm-2">
                </div>
                </div>
            <div class="container" style="width:100%">
                <ul class="nav nav-pills">
                    <li class="active">
                        <a data-toggle="pill" id="auto-mode" 
                         href="#home">Auto mode
                        </a>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Scaling
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#">
                                    <div id="scalingout">Scale Out FortiGate</div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div id="scalingin">Scale In FortiGate</div>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Tester
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#">
                                    <div id="starttest">Start Test Traffic</div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div id="stoptest">Stop Test Traffic</div>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Charts & Data
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#">
                                    <div id="resetdata">Clean Charts</div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div id="keepolddata">Accumulative X-axis (300 samples or 20 mins)</div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div id="deleteolddata">Moving X-axis</div>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Reset
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#">
                                    <div id="panic">Panic: General Reset</div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div id="synchronize_counters">Synchronize Orchestrator counters</div>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>

                <div class="tab-content">
                    <div id="home" class="tab-pane fade in active">
                        <div class="row">
                                <div class="col-sm-2">
                                        <div class="panel panel-default">
                                            <div class="panel-heading">CPU Load Host 1</div>
                                            <div class="panel-body">
                                                <div id="cpuload_time1" style="width:100%; float:left; height:20vh;"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-10">
                                        <div class="panel panel-default">
                                            <div class="panel-heading">FortiGate Load</div>
                                            <div class="panel-body">
                                                <div id="fgtload_time1" style="width:12.4%; float:left; height:19vh;"></div>
                                                <div id="fgtload_time2" style="width:12.4%; float:left; height:19vh;"></div>
                                                <div id="fgtload_time3" style="width:12.4%; float:left; height:19vh;"></div>
                                                <div id="fgtload_time4" style="width:12.4%; float:left; height:19vh;"></div>
                                                <div id="fgtload_time5" style="width:12.4%; float:left; height:19vh;"></div>
                                                <div id="fgtload_time6" style="width:12.4%; float:left; height:19vh;"></div>
                                                <div id="fgtload_time7" style="width:12.4%; float:left; height:19vh;"></div>
                                                <div id="fgtload_time8" style="width:12.4%; float:left; height:19vh;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                        <div class="row">
                            <div class="col-sm-2">
                                <div class="panel panel-default">
                                    <div class="panel-heading">CPU Load Host 2</div>
                                    <div class="panel-body">
                                        <div id="cpuload_time2" style="width:100%; float:left; height:20vh;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-10">
                                <div class="panel panel-default">
                                    <div class="panel-heading">FortiGate Sessions<div class="square" id="sync_warning" style="float:right"></div></div>
                                    <div class="panel-body">
                                        <div id="fgtsess_time1" style="width:12.4%; float:left; height:19vh;"></div>
                                        <div id="fgtsess_time2" style="width:12.4%; float:left; height:19vh;"></div>
                                        <div id="fgtsess_time3" style="width:12.4%; float:left; height:19vh;"></div>
                                        <div id="fgtsess_time4" style="width:12.4%; float:left; height:19vh;"></div>
                                        <div id="fgtsess_time5" style="width:12.4%; float:left; height:19vh;"></div>
                                        <div id="fgtsess_time6" style="width:12.4%; float:left; height:19vh;"></div>
                                        <div id="fgtsess_time7" style="width:12.4%; float:left; height:19vh;"></div>
                                        <div id="fgtsess_time8" style="width:12.4%; float:left; height:19vh;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-5">
                                <div class="panel panel-default">
                                    <div class="panel-heading">Total Throughput</div>
                                    <div class="panel-body">
                                        <div id="totalthroughput_time" style="width:100%; float:left; height:25vh;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-7">
                                <div class="panel panel-default">
                                    <div class="panel-heading">FortiGate Throughput [SDN Layer]</div>
                                    <div class="panel-body">
                                        <div id="fgtthroughput_time" style="width:100%; float:left; height:25vh;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal -->
            <div id="scaleout_fgt" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Scaling out FortiGate</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="text">FortiGate identifier(2-8):</label>
                                <select class="form-control" id="fgt_id_scale_out">
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                    <option>6</option>
                                    <option>7</option>
                                    <option>8</option>
                                </select>
                            </div>
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated progress-bar-info active" 
                                        role="progressbar" id="progress_bar_scale_out" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">0%
                                </div>
                            </div>
                            <div id="start_vm_log">
                                <p></p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-success" id="start_fgt_btn">Start</button>
                            <button type="button" class="btn btn-default" id="close_start_fgt_btn" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Modal -->
            <div id="scalein_fgt" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Scaling in FortiGate</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="text">FortiGate identifier (2-8):</label>
                                <select class="form-control" id="fgt_id_scale_in">
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                    <option>6</option>
                                    <option>7</option>
                                    <option>8</option>
                                </select>
                            </div>
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated progress-bar-info active" 
                                        role="progressbar" id="progress_bar_scale_in" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">0%
                                </div>
                            </div>
                            <div id="stop_vm_log">
                                <p></p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-success" id="stop_fgt_btn">Stop</button>
                            <button type="button" class="btn btn-default" id="close_stop_fgt_btn" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Modal -->
            <div id="start_test" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Start Traffic</h4>
                        </div>
                        <div class="modal-body">
                            <div id="start_test_log">
                                <p></p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Modal -->
            <div id="stop_test" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Stop Trafic</h4>
                        </div>
                        <div class="modal-body">
                            <div id="stop_test_log">
                                <p></p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Modal -->
            <div id="panic_view" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">General Reset</h4>
                        </div>
                        <div class="modal-body">
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated progress-bar-info active" 
                                        role="progressbar" id="progress_bar_panic" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">0%
                                </div>
                            </div>
                            <div id="panic_log">
                                <p></p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" id="close_panic_btn" data-dismiss="modal">Close</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>        
</body>

</html>
